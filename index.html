<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STK 策略選房系統</title>

<style>
body{
    margin:0;
    padding:0 10px 90px;
    background:#000;
    color:#fff;
    font-family:"Microsoft JhengHei",Arial,sans-serif;
    overflow-x:hidden;
}

/* ===== Matrix ===== */
#bgCanvas{
    position:fixed;
    inset:0;
    z-index:-2;
}

/* ===== Header ===== */
.header{
    position:fixed;
    top:6px;left:0;right:0;
    z-index:999;
    pointer-events:none;
}
.logo{
    position:absolute;
    animation:float 3s ease-in-out infinite alternate;
}
#logoLeft{left:8px;width:110px;}
#logoRight{right:8px;width:80px;}

@keyframes float{
    0%,100%{transform:translateY(0);}
    50%{transform:translateY(-4px);}
}

/* ===== Main ===== */
.container{
    max-width:420px;
    margin:86px auto 0;
    text-align:center;
}

h1{
    font-size:20px;
    margin:0 0 14px;
    transition:.3s;
}

/* ===== Mode Toggle ===== */
.toggle{
    width:120px;
    margin:0 auto 12px;
    padding:8px 0;
    border-radius:20px;
    font-size:13px;
    font-weight:bold;
    cursor:pointer;
    user-select:none;
}

/* ===== Loading ===== */
#dataPanel{
    display:none;
    margin-top:12px;
    padding:10px;
    font-family:Consolas,monospace;
    font-size:11px;
    background:rgba(0,0,0,.6);
}
#progressContainer{
    display:none;
    width:90%;
    height:10px;
    margin:8px auto;
    background:rgba(255,255,255,.2);
    border-radius:10px;
}
#progressBar{
    height:100%;
    width:0%;
}

/* ===== Slots ===== */
.slot-container{
    display:none;
    grid-template-columns:1fr;
    gap:10px;
    margin-top:16px;
}
.slot{
    padding:10px 14px;
    border-radius:12px;
    background:rgba(0,0,0,.82);
    display:flex;
    justify-content:space-between;
    font-size:14px;
    opacity:0;
    transform:translateY(8px);
    transition:.35s;
}
.slot.show{opacity:1;transform:none;}

@keyframes mega{
    0%,100%{
        transform:scale(1);
        filter:brightness(1) saturate(1.4);
    }
    50%{
        transform:scale(1.06);
        filter:brightness(1.02) saturate(2);
    }
}
</style>
</head>

<body>
<canvas id="bgCanvas"></canvas>

<div class="header">
    <img src="logo.png" class="logo" id="logoLeft">
    <img src="logo2.png" class="logo" id="logoRight">
</div>

<div class="container">
    <h1 id="title"></h1>

    <div class="toggle" id="toggle" onclick="switchMode()"></div>

    <div id="dataPanel"></div>
    <div id="progressContainer"><div id="progressBar"></div></div>

    <div id="slots" class="slot-container"></div>
</div>

<script>
/* ===== Matrix ===== */
const c=document.getElementById("bgCanvas"),x=c.getContext("2d");
let cols,drops=[],matrixColor="#ff9f1c";
function resize(){
    c.width=innerWidth;c.height=innerHeight;
    cols=Math.floor(c.width/22);
    drops=Array(cols).fill(1);
}
resize();onresize=resize;
function draw(){
    x.fillStyle="rgba(0,0,0,.18)";
    x.fillRect(0,0,c.width,c.height);
    x.fillStyle=matrixColor;
    x.font="13px monospace";
    for(let i=0;i<drops.length;i++){
        x.fillText(Math.random()>.5?"1":"0",i*22,drops[i]*22);
        if(drops[i]*22>c.height&&Math.random()>.99)drops[i]=0;
        drops[i]+=.25; // 降速
    }
    requestAnimationFrame(draw);
}
draw();

/* ===== App ===== */
let mode="II";
const title=document.getElementById("title");
const toggle=document.getElementById("toggle");
const dataPanel=document.getElementById("dataPanel");
const slots=document.getElementById("slots");
const bar=document.getElementById("progressBar");
const progress=document.getElementById("progressContainer");

function applyTheme(){
    if(mode==="II"){
        title.textContent="STK 策略專屬｜爆分選房系統";
        title.style.color="#ffb347";
        toggle.textContent="MODE II";
        toggle.style.background="linear-gradient(180deg,#ffb347,#ff7b00)";
        matrixColor="#ff9f1c";
        bar.style.background="linear-gradient(90deg,#ffb347,#ff7b00)";
    }else{
        title.textContent="STK 策略專屬｜穩定選房系統";
        title.style.color="#8dffbe";
        toggle.textContent="MODE I";
        toggle.style.background="linear-gradient(180deg,#3dff9f,#00995a)";
        matrixColor="#00ff9c";
        bar.style.background="linear-gradient(90deg,#3dff9f,#00995a)";
    }
}

async function fakeLoading(){
    dataPanel.innerHTML="";
    dataPanel.style.display="block";
    progress.style.display="block";
    const lines=[
        "Initializing room database...",
        "Calculating burst model...",
        "Predicting output..."
    ];
    for(let l of lines){
        let d=document.createElement("div");
        dataPanel.appendChild(d);
        let p=0;
        await new Promise(r=>{
            (function s(){
                p+=Math.random()*7;
                if(p>100)p=100;
                d.textContent=l+" ("+Math.floor(p)+"%)";
                bar.style.width=p+"%";
                p<100?requestAnimationFrame(s):setTimeout(r,120);
            })();
        });
    }
}

function genSlots(){
    let a=[];
    for(let i=0;i<2;i++)a.push({t:"top",p:88+Math.random()*6|0});
    for(let i=0;i<5;i++)a.push({t:"high",p:72+Math.random()*10|0});
    while(a.length<8)a.push({t:"n",p:50+Math.random()*25|0});
    return a.sort(()=>Math.random()-.5);
}

async function refresh(){
    slots.style.display="none";
    await fakeLoading();
    dataPanel.style.display="none";
    progress.style.display="none";
    slots.innerHTML="";
    slots.style.display="grid";
    genSlots().forEach((d,i)=>{
        let s=document.createElement("div");
        s.className="slot";
        if(d.t==="top"){
            s.style.color=mode==="II"?"#ff9f1c":"#00ff9c";
            s.style.boxShadow="0 0 20px currentColor";
            s.style.animation="mega 1.8s infinite";
        }
        s.innerHTML=`<span>第 ${Math.floor(Math.random()*3000)} 房</span><span>${d.p}%</span>`;
        slots.appendChild(s);
        setTimeout(()=>s.classList.add("show"),i*60);
    });
}

function switchMode(){
    mode=mode==="II"?"I":"II";
    applyTheme();
    refresh();
}

applyTheme();
refresh();
</script>
</body>
</html>
