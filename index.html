<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STK 策略選房系統</title>

<style>
body{
    margin:0;
    padding:0 10px 90px;
    background:#000;
    color:#fff;
    font-family:"Microsoft JhengHei",Arial,sans-serif;
    overflow-x:hidden;
}
#bgCanvas{position:fixed;inset:0;z-index:-2;}

.header{
    position:fixed;
    top:8px;left:0;right:0;
    pointer-events:none;
    z-index:999;
}
.logo{position:absolute;animation:float 3s ease-in-out infinite alternate;}
#logoLeft{left:8px;width:120px;}
#logoRight{right:8px;width:88px;}

@keyframes float{
    0%,100%{transform:translateY(0);}
    50%{transform:translateY(-5px);}
}

.container{
    max-width:420px;
    margin:88px auto 0;
    text-align:center;
}

h1{font-size:20px;margin:0 0 14px;color:#ffb347;}

button{
    width:90%;max-width:300px;
    padding:12px;font-size:14px;font-weight:bold;
    border:none;border-radius:18px;
    color:#fff;
    background:linear-gradient(180deg,#ffb347,#ff7b00);
}

#dataPanel{
    display:none;margin-top:14px;padding:12px;
    font-family:Consolas,monospace;font-size:11px;
    background:rgba(0,0,0,.6);
}

#progressContainer{
    display:none;width:90%;height:12px;
    margin:10px auto;background:rgba(255,255,255,.2);
    border-radius:10px;
}
#progressBar{
    height:100%;width:0%;
    background:linear-gradient(90deg,#ffb347,#ff7b00);
}

.slot-container{
    display:none;grid-template-columns:1fr;
    gap:10px;margin-top:18px;
}
.slot{
    padding:12px 14px;border-radius:12px;
    background:rgba(0,0,0,.82);
    display:flex;justify-content:space-between;
    font-size:14px;
    opacity:0;transform:translateY(10px);
    transition:.35s;
}
.slot.show{opacity:1;transform:none;}

@keyframes mega{
    0%,100%{transform:scale(1);filter:brightness(1) saturate(1.3);}
    50%{transform:scale(1.08);filter:brightness(1.05) saturate(1.9);}
}
</style>
</head>

<body>
<canvas id="bgCanvas"></canvas>

<div class="header">
    <img src="logo.png" class="logo" id="logoLeft">
    <img src="logo2.png" class="logo" id="logoRight">
</div>

<div class="container">
    <h1>STK 策略專屬｜爆分選房</h1>
    <button onclick="refresh()">五分鐘換一次</button>

    <div id="dataPanel"></div>
    <div id="progressContainer"><div id="progressBar"></div></div>
    <div id="slots" class="slot-container"></div>
</div>

<script>
/* Matrix */
const c=document.getElementById("bgCanvas"),x=c.getContext("2d");
let cols,drops=[];
function resize(){
    c.width=innerWidth;c.height=innerHeight;
    cols=Math.floor(c.width/22);
    drops=Array(cols).fill(1);
}
resize();onresize=resize;
function draw(){
    x.fillStyle="rgba(0,0,0,.15)";
    x.fillRect(0,0,c.width,c.height);
    x.fillStyle="#ff9f1c";
    x.font="14px monospace";
    for(let i=0;i<drops.length;i++){
        x.fillText(Math.random()>.5?"1":"0",i*22,drops[i]*22);
        if(drops[i]*22>c.height&&Math.random()>.985)drops[i]=0;
        drops[i]+=.35;
    }
    requestAnimationFrame(draw);
}
draw();

/* App */
const dataPanel=document.getElementById("dataPanel");
const slots=document.getElementById("slots");
const bar=document.getElementById("progressBar");
const progress=document.getElementById("progressContainer");

async function fakeLoading(){
    dataPanel.innerHTML="";
    dataPanel.style.display="block";
    progress.style.display="block";
    const lines=[
        "Initializing room database...",
        "Calculating burst model...",
        "Predicting output..."
    ];
    for(let l of lines){
        let d=document.createElement("div");
        dataPanel.appendChild(d);
        let p=0;
        await new Promise(r=>{
            (function s(){
                p+=Math.random()*8;
                if(p>100)p=100;
                d.textContent=l+" ("+Math.floor(p)+"%)";
                bar.style.width=p+"%";
                p<100?requestAnimationFrame(s):setTimeout(r,120);
            })();
        });
    }
}

function gen(){
    let a=[];
    for(let i=0;i<2;i++)a.push({t:"top",p:88+Math.random()*6|0});
    for(let i=0;i<5;i++)a.push({t:"high",p:72+Math.random()*10|0});
    while(a.length<8)a.push({t:"n",p:50+Math.random()*25|0});
    return a.sort(()=>Math.random()-.5);
}

async function refresh(){
    slots.style.display="none";
    await fakeLoading();
    dataPanel.style.display="none";
    progress.style.display="none";
    slots.innerHTML="";
    slots.style.display="grid";
    gen().forEach((d,i)=>{
        let s=document.createElement("div");
        s.className="slot";
        if(d.t==="top"){
            s.style.color="#ff9f1c";
            s.style.boxShadow="0 0 22px rgba(255,159,28,.85)";
            s.style.animation="mega 1.8s infinite";
        }
        s.innerHTML=`<span>第 ${Math.floor(Math.random()*3000)} 房</span><span>${d.p}%</span>`;
        slots.appendChild(s);
        setTimeout(()=>s.classList.add("show"),i*60);
    });
}
refresh();
</script>
</body>
</html>
